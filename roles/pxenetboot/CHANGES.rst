Changelog
=========

.. include:: includes/all.rst

**debops.dnsmasq**

This project adheres to `Semantic Versioning <http://semver.org/spec/v2.0.0.html>`__
and `human-readable changelog <http://keepachangelog.com/en/0.3.0/>`__.

The current repository maintainer is drybjed_.


debops.dnsmasq v0.1.0 - unreleased
----------------------------------

Added
~~~~~

- Add Changelog. [drybjed_]

- Add variables to enable / disable ``bogus-priv`` and ``stop-dns-rebind``
  options. These need to be disabled if you want to experiment with multiple
  nested private networks without DNS issues. [drybjed_]

- Allow to use custom upstream nameservers. [ypid_]

- Add :envvar:`dnsmasq__group_options` and :envvar:`dnsmasq__host_options` with
  the same function as :envvar:`dnsmasq__options`. [ypid_]

- Add :envvar:`dnsmasq__external_dns` which can be used to only provided DNS
  for localhost. [ypid_]

- Add :envvar:`dnsmasq__apparmor__local_dependent_config` and a example
  playbook to configure AppArmor so that all features of this role work with
  AppArmor enforcing the dnsmasq profile. [ypid_]

- Don’t forward reserved or private top level DNS names to upstream DNS
  servers. [ypid_]

- Add :envvar:`dnsmasq__dns_not_forward_managed` to allow to change how the
  :envvar:`dnsmasq__domain` is handled. [ypid_]

Changed
~~~~~~~

- Change default TFTP root directory to :file:`/srv/tftp/` to be compatible with
  defaults from ``tftpd-hpa`` package. [drybjed_]

- Switch from PXE boot to iPXE boot and drop support for installation of Debian
  Netboot Installer. Custom menu will be handled by a separate role. [drybjed_]

- Use real hostname as the ``A`` record on the gateway interface and point
  ``gw`` ``CNAME`` to it. [drybjed_]

- Create TFTP root directory if not present. [drybjed_]

- Use ``bind-dynamic`` option in newer OSes instead of ``bind-interfaces``,
  this should fix an issue when changes in the network interface topology
  required ``dnsmasq`` to be restarted to listen on new interfaces. [drybjed_]

- Support a list for :envvar:`dnsmasq__etc_hosts` and don’t read any hosts file
  by default. [ypid_]

- Changed variable namespace from ``dnsmasq_`` to ``dnsmasq__``.
  ``dnsmasq_[^_]`` variables are hereby deprecated.

  You might need to update your inventory. This oneliner might come in handy to
  do this:

  .. code:: shell

     git ls-files -z | xargs --null -I '{}' find '{}' -type f -print0 | xargs --null sed --in-place --regexp-extended 's/\<(dnsmasq)_([^_])/\1__\2/g;'

  [ypid_]

- Move condition for :envvar:`dnsmasq__bogus_priv` to the defaults file to make
  transparent when this option is going to be applied. [ypid_]

- Change :envvar:`dnsmasq__domain` to point to ``ansible_domain`` instead of
  ``ansible_fqdn`` by default. [ypid_]

Removed
~~~~~~~

- Remove "short subdomain" ``CNAME`` entries generated by Ansible from
  ``dnsmasq`` configuration. These entries may confuse DNS, it's better if
  ``search`` parameter in :file:`/etc/resolv.conf` includes all relevant domains
  and subdomains instead. [drybjed_]

- Remove "short subdomain" ``CNAME`` entries from main ``dnsmasq``
  configuration file. [drybjed_]

- Remove the ``debops_dnsmasq`` Ansible inventory group. Make sure you hosts
  are in ``debops_service_dnsmasq``. [ypid_]

- Remove all of the Ansible role dependencies.

  Configuration of dependent services like firewall, TCP Wrappers is set in
  separate default variables. These variables can be used by the Ansible
  playbooks to configure settings related to ``dnsmasq`` in other services.
  [ypid_]

Fixed
~~~~~

- Detection of :envvar:`dnsmasq__bogus_priv` which did not work before because the
  ``bool`` filter interprets defaults to ``False`` for input it does not know
  about (like IP addresses). [ypid_]
